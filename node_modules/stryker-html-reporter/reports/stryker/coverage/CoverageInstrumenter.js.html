<html>
<head>
    <title>CoverageInstrumenter.js - Stryker report</title>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../bootstrap/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../highlightjs/styles/default.css">
    <link rel="stylesheet" href="../stryker.css">
</head>

<body>  
    <img class="stryker-image" alt="Stryker" src="../stryker-80x80.png">

    <div class="container-fluid">
        <h1>CoverageInstrumenter.js - Stryker report</h1><div class="col-md-12">
    <h2>Summary</h2>
    <div class="row">
        <div class="col-xs-11">
            <table class="table table-hover table-bordered table-no-top">
                <thead>
                    <tr>
                        <th style="width: 20%"><div><span>File</span></div></th>
                        <th colspan="2"><div><span>Mutation score</span></div></th>
                        <th class="rotate text-center" style="width: 50px"><div><span># Killed</span></div></th>
                        <th class="rotate text-center" style="width: 50px"><div><span># Survived</span></div></th>
                        <th class="rotate text-center" style="width: 50px"><div><span># Timeout</span></div></th>
                        <th class="rotate text-center" style="width: 50px"><div><span># No coverage</span></div></th>
                        <th class="rotate text-center" style="width: 50px"><div><span># Errors</span></div></th>
                        <th class="rotate rotate-width-70 text-center" style="width: 70px"><div><span>Total detected</span></div></th>
                        <th class="rotate rotate-width-70 text-center" style="width: 70px"><div><span>Total undetected</span></div></th>
                        <th class="rotate rotate-width-70 text-center" style="width: 70px"><div><span>Total mutants</span></div></th>
                    </tr>
                </thead>                <tbody>
                    <tr>
                        <td><a href="CoverageInstrumenter.js.html">CoverageInstrumenter.js</a></td>
                        <td>
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="84" aria-valuemin="0" aria-valuemax="100"
                                    style="width: 84%;">
                                    84%
                                </div>
                            </div>
                        </td>
                        <th class="text-center" style="width: 10%">21/25</th>
                        <td class="text-center">21</td>
                        <td class="text-center">4</td>
                        <td class="text-center">0</td>
                        <td class="text-center">0</td>
                        <td class="text-center">0</td>
                        <th class="text-center">21</th>
                        <th class="text-center">4</th>
                        <th class="text-center">25</th>
                    </tr>                </tbody>
            </table>
        </div>
    </div>
    <h2>Code</h2>
    <div class="row">
        <div class="col-sm-6">
           <a href="#" class="stryker-collapse-expand-all">Expand all</a>
        </div>
        <div class="col-sm-offset-2 col-sm-4">
            <label>
                <input class="stryker-display-killed" type="checkbox"> Also show killed mutants
            </label>
        </div>
    </div>
    <pre><code class="lang-javascript"><span class="bg-null">&quot;use strict&quot;;
var log4js &#x3D; require(&#x27;log4js&#x27;);
var stream_1 &#x3D; require(&#x27;stream&#x27;);
var objectUtils_1 &#x3D; require(&#x27;../utils/objectUtils&#x27;);
var CoverageInstrumenterStream_1 &#x3D; require(&#x27;./CoverageInstrumenterStream&#x27;);
var log &#x3D; log4js.getLogger(&#x27;CoverageInstrumenter&#x27;);
var COVERAGE_CURRENT_TEST_VARIABLE_NAME &#x3D; &#x27;__strykerCoverageCurrentTest__&#x27;;
/**
 * Represents the CoverageInstrumenter
 * Responsible for managing the instrumentation of all files to be mutated.
 * In case of &#x60;perTest&#x60; coverageAnalysis it will hookin to the test framework to accomplish that.
 */
var CoverageInstrumenter &#x3D; (function () </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="0"><span class="label label-success">0</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="0">{
}</span><span class="stryker-original-code" data-mutant="0"><span class="bg-success">{
    function CoverageInstrumenter(coverageAnalysis, testFramework) </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="1"><span class="label label-success">1</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="1">{
}</span><span class="stryker-original-code" data-mutant="1"><span class="bg-success">{
        this.coverageAnalysis &#x3D; coverageAnalysis;
        this.testFramework &#x3D; testFramework;
        this.coverageInstrumenterStreamPerFile &#x3D; Object.create(null);
    }</span></span><span class="bg-success">
    CoverageInstrumenter.prototype.instrumenterStreamForFile &#x3D; function (file) </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="2"><span class="label label-success">2</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="2">{
}</span><span class="stryker-original-code" data-mutant="2"><span class="bg-success">{
        if (</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="3"><span class="label label-success">3</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="3">false</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="4"><span class="label label-success">4</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="4">true</span><span class="stryker-original-code" data-mutant="3"><span class="stryker-original-code" data-mutant="4"><span class="bg-success">file.mutated</span></span></span><span class="bg-success">) </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="5"><span class="label label-success">5</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="5">{
}</span><span class="stryker-original-code" data-mutant="5"><span class="bg-success">{
            /*
            Coverage variable *must* have the name &#x27;__coverage__&#x27;. Only that variable
            is reported back to the TestRunner process when using one of the karma
            test framework adapters (karma-jasmine, karma-mocha, ...).
      
            However, when coverageAnalysis is &#x27;perTest&#x27; we don&#x27;t choose that variable name right away,
            because we need that variable to hold all coverage results per test. Instead, we use __strykerCoverageCurrentTest__
            and after each test copy over the value of that current test to the global coverage object __coverage__
             */
            switch (this.coverageAnalysis) {
                case &#x27;all&#x27;:
                    return this.createStreamForFile(&#x27;__coverage__&#x27;, file.path);
                case &#x27;perTest&#x27;:
                    return this.createStreamForFile(COVERAGE_CURRENT_TEST_VARIABLE_NAME, file.path);
            }
        }</span></span><span class="bg-success">
        // By default, do not instrument for code coverage
        return new stream_1.PassThrough();
    }</span></span><span class="bg-success">;
    CoverageInstrumenter.prototype.hooksForTestRun &#x3D; function () </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="6"><span class="label label-success">6</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="6">{
}</span><span class="stryker-original-code" data-mutant="6"><span class="bg-success">{
        if (</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="7"><span class="label label-success">7</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="7">false</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="8"><span class="label label-success">8</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="8">true</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="9"><span class="label label-success">9</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="9">this.coverageAnalysis !&#x3D;&#x3D; &#x27;perTest&#x27;</span><span class="stryker-original-code" data-mutant="7"><span class="stryker-original-code" data-mutant="8"><span class="stryker-original-code" data-mutant="9"><span class="bg-success">this.coverageAnalysis &#x3D;&#x3D;&#x3D; &#x27;perTest&#x27;</span></span></span></span><span class="bg-success">) </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="10"><span class="label label-success">10</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="10">{
}</span><span class="stryker-original-code" data-mutant="10"><span class="bg-success">{
            log.debug(&quot;Adding test hooks file for coverageAnalysis \&quot;perTest\&quot;&quot;);
            return objectUtils_1.wrapInClosure(</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="11"><span class="label label-success">11</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="11">&#x27;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &#x27; + this.testFramework.beforeEach(beforeEachFragmentPerTest) + &#x27;\n          &#x27; + this.testFramework.afterEach(afterEachFragmentPerTest) + &#x27;\n          &#x27; + cloneFunctionFragment - &#x27;;\n      &#x27;</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="12"><span class="label label-success">12</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="12">&#x27;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &#x27; + this.testFramework.beforeEach(beforeEachFragmentPerTest) + &#x27;\n          &#x27; + this.testFramework.afterEach(afterEachFragmentPerTest) + &#x27;\n          &#x27; - cloneFunctionFragment</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="13"><span class="label label-success">13</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="13">&#x27;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &#x27; + this.testFramework.beforeEach(beforeEachFragmentPerTest) + &#x27;\n          &#x27; + this.testFramework.afterEach(afterEachFragmentPerTest) - &#x27;\n          &#x27;</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="14"><span class="label label-success">14</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="14">&#x27;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &#x27; + this.testFramework.beforeEach(beforeEachFragmentPerTest) + &#x27;\n          &#x27; - this.testFramework.afterEach(afterEachFragmentPerTest)</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="15"><span class="label label-success">15</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="15">&#x27;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &#x27; + this.testFramework.beforeEach(beforeEachFragmentPerTest) - &#x27;\n          &#x27;</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="16"><span class="label label-success">16</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="16">&#x27;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &#x27; - this.testFramework.beforeEach(beforeEachFragmentPerTest)</span><span class="stryker-original-code" data-mutant="11"><span class="stryker-original-code" data-mutant="12"><span class="stryker-original-code" data-mutant="13"><span class="stryker-original-code" data-mutant="14"><span class="stryker-original-code" data-mutant="15"><span class="stryker-original-code" data-mutant="16"><span class="bg-success">&quot;\n          var id &#x3D; 0, coverageStateAtStart;\n          window.__coverage__ &#x3D; globalCoverage &#x3D; {};\n\n          &quot; + this.testFramework.beforeEach(beforeEachFragmentPerTest)</span></span><span class="bg-success"> + &quot;\n          &quot;</span></span><span class="bg-success"> + this.testFramework.afterEach(afterEachFragmentPerTest)</span></span><span class="bg-success"> + &quot;\n          &quot;</span></span><span class="bg-success"> + cloneFunctionFragment</span></span><span class="bg-success"> + &quot;;\n      &quot;</span></span><span class="bg-success">);
        }</span></span><span class="bg-success">
        else </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="17"><span class="label label-success">17</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="17">{
}</span><span class="stryker-original-code" data-mutant="17"><span class="bg-success">{
            return &#x27;&#x27;;
        }</span></span><span class="bg-success">
    }</span></span><span class="bg-success">;
    CoverageInstrumenter.prototype.retrieveStatementMapsPerFile &#x3D; function () </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="18"><span class="label label-success">18</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="18">{
}</span><span class="stryker-original-code" data-mutant="18"><span class="bg-success">{
        var _this &#x3D; this;
        var statementMapsPerFile &#x3D; Object.create(null);
        Object.keys(this.coverageInstrumenterStreamPerFile)
            .forEach(function (key) </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="19"><span class="label label-success">19</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="19">{
}</span><span class="stryker-original-code" data-mutant="19"><span class="bg-success">{ return statementMapsPerFile[key] &#x3D; _this.coverageInstrumenterStreamPerFile[key].statementMap; }</span></span><span class="bg-success">);
        return statementMapsPerFile;
    }</span></span><span class="bg-success">;
    CoverageInstrumenter.prototype.createStreamForFile &#x3D; function (coverageVariable, fileName) </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="success" data-mutant="20"><span class="label label-success">20</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="20">{
}</span><span class="stryker-original-code" data-mutant="20"><span class="bg-success">{
        var stream &#x3D; new CoverageInstrumenterStream_1.default(coverageVariable, fileName);
        this.coverageInstrumenterStreamPerFile[fileName] &#x3D; stream;
        return stream;
    }</span></span><span class="bg-success">;
    return CoverageInstrumenter;
}</span></span><span class="bg-null">());
Object.defineProperty(exports, &quot;__esModule&quot;, { value: true });
exports.default &#x3D; CoverageInstrumenter;
var cloneFunctionFragment &#x3D; &quot;    \n    function clone(source) {\n        var result &#x3D; source;\n        if (Array.isArray(source)) {\n            result &#x3D; [];\n            source.forEach(function (child, index) {\n                result[index] &#x3D; clone(child);\n            });\n        } else if (typeof source &#x3D;&#x3D; \&quot;object\&quot;) {\n            // it is an object literal\n            result &#x3D; {};\n            for (var i in source) {\n                result[i] &#x3D; clone(source[i]);\n            }\n        }\n        return result;\n    }&quot;;
var beforeEachFragmentPerTest &#x3D; </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="danger" data-mutant="21"><span class="label label-danger">21</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="21">&#x27;\nif (!coverageStateAtStart) {\n  coverageStateAtStart &#x3D; clone(window.&#x27; + COVERAGE_CURRENT_TEST_VARIABLE_NAME - &#x27;);\n}&#x27;</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="danger" data-mutant="22"><span class="label label-danger">22</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="22">&#x27;\nif (!coverageStateAtStart) {\n  coverageStateAtStart &#x3D; clone(window.&#x27; - COVERAGE_CURRENT_TEST_VARIABLE_NAME</span><span class="stryker-original-code" data-mutant="21"><span class="stryker-original-code" data-mutant="22"><span class="bg-danger">&quot;\nif (!coverageStateAtStart) {\n  coverageStateAtStart &#x3D; clone(window.&quot; + COVERAGE_CURRENT_TEST_VARIABLE_NAME</span></span><span class="bg-danger"> + &quot;);\n}&quot;</span></span><span class="bg-null">;
var afterEachFragmentPerTest &#x3D; </span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="danger" data-mutant="23"><span class="label label-danger">23</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="23">&#x27;\n       globalCoverage[id] &#x3D; coverageResult &#x3D; {};\n      id++;\n           var coveragePerTest &#x3D; window.&#x27; + COVERAGE_CURRENT_TEST_VARIABLE_NAME - &#x27;;\n            Object.keys(coveragePerTest).forEach(function (file) {\n                var coverage &#x3D; coveragePerTest[file];\n                coverageResult[file] &#x3D; { s: coverage.s };\n                coverage.s &#x3D; clone(coverageStateAtStart[file].s);\n            });&#x27;</span><a href="#" class="stryker-mutant-button" data-mutant-status-annotation="danger" data-mutant="24"><span class="label label-danger">24</span></a><span class="label label-info stryker-mutant-replacement" hidden data-mutant="24">&#x27;\n       globalCoverage[id] &#x3D; coverageResult &#x3D; {};\n      id++;\n           var coveragePerTest &#x3D; window.&#x27; - COVERAGE_CURRENT_TEST_VARIABLE_NAME</span><span class="stryker-original-code" data-mutant="23"><span class="stryker-original-code" data-mutant="24"><span class="bg-danger">&quot;\n       globalCoverage[id] &#x3D; coverageResult &#x3D; {};\n      id++;\n           var coveragePerTest &#x3D; window.&quot; + COVERAGE_CURRENT_TEST_VARIABLE_NAME</span></span><span class="bg-danger"> + &quot;;\n            Object.keys(coveragePerTest).forEach(function (file) {\n                var coverage &#x3D; coveragePerTest[file];\n                coverageResult[file] &#x3D; { s: coverage.s };\n                coverage.s &#x3D; clone(coverageStateAtStart[file].s);\n            });&quot;</span></span><span class="bg-null">;
//# sourceMappingURL&#x3D;CoverageInstrumenter.js.ma</span>p</code></pre>
</div><footer>
    Generated with stryker-html-reporter generator. Visit the <a href="http://stryker-mutator.github.io" target="_blank">Stryker website</a></footer>
</div>
<script src="../stryker.js" defer></script>
</body>
</html>